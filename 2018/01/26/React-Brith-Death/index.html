<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="React," />










<meta name="description" content="React的基本操作123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990import PropTypes f">
<meta name="keywords" content="React">
<meta property="og:type" content="article">
<meta property="og:title" content="React的前世今生">
<meta property="og:url" content="http://yoursite.com/2018/01/26/React-Brith-Death/index.html">
<meta property="og:site_name" content="朝花夕拾">
<meta property="og:description" content="React的基本操作123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990import PropTypes f">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-01-29T08:05:42.192Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="React的前世今生">
<meta name="twitter:description" content="React的基本操作123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990import PropTypes f">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/01/26/React-Brith-Death/"/>





  <title>React的前世今生 | 朝花夕拾</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">朝花夕拾</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/26/React-Brith-Death/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="踽踽前行的路人">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="朝花夕拾">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">React的前世今生</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-26T17:25:02+08:00">
                2018-01-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/React/" itemprop="url" rel="index">
                    <span itemprop="name">React</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <hr>
<h1 id="React的基本操作"><a href="#React的基本操作" class="headerlink" title="React的基本操作"></a>React的基本操作</h1><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span>;</div><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;button style=&#123;&#123;<span class="attr">background</span>: <span class="keyword">this</span>.context.color&#125;&#125;&gt;</div><div class="line">        &#123;<span class="keyword">this</span>.props.children&#125;</div><div class="line">      &lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">    );</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">Button.contextTypes = &#123;</span></div><div class="line"><span class="regexp">  color: PropTypes.string</span></div><div class="line"><span class="regexp">&#125;;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">class Message extends React.Component &#123;</span></div><div class="line"><span class="regexp">  render() &#123;</span></div><div class="line"><span class="regexp">    return (</span></div><div class="line"><span class="regexp">      &lt;div&gt;</span></div><div class="line"><span class="regexp">        &#123;this.props.text&#125; &lt;Button&gt;Delete&lt;/</span>Button&gt;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    );</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">class MessageList extends React.Component &#123;</span></div><div class="line"><span class="regexp">    /</span>**构造函数的使用，ES6为了模仿JAVA,C++等oop的对象继承方式</div><div class="line">        <span class="number">1.</span>在组件未加载之前调用</div><div class="line">        <span class="number">2.</span>调用<span class="keyword">super</span>(props)用于props的初始化</div><div class="line">        <span class="number">3.</span>初始化组件State</div><div class="line">    **<span class="regexp">/</span></div><div class="line"><span class="regexp">    constructor(props,context) &#123;</span></div><div class="line"><span class="regexp">    super(props);</span></div><div class="line"><span class="regexp">    this.state = &#123; &#125;;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    /</span><span class="regexp">/定义组件的默认属性</span></div><div class="line"><span class="regexp">     static defaultProps = &#123;</span></div><div class="line"><span class="regexp">    name: 'stranger'</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">    /</span>**</div><div class="line">    <span class="number">1.</span>render()函数调用之前</div><div class="line">    <span class="number">2.</span>用于服务端渲染使用</div><div class="line">    <span class="number">3.</span>(同步)调用setState会不会触发render()，但是state中的值会发生变化</div><div class="line">    **<span class="regexp">/</span></div><div class="line"><span class="regexp">    componentWillMount()&#123;&#125;</span></div><div class="line"><span class="regexp">    render() &#123;</span></div><div class="line"><span class="regexp">    const children = this.props.messages.map((message) =&gt;</span></div><div class="line"><span class="regexp">      &lt;Message text=&#123;message.text&#125; /</span>&gt;</div><div class="line">    );</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;&#123;children&#125;&lt;/div&gt;;</div><div class="line">   &#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">    在组件加载完调用(render()调用完，被调用)</span></div><div class="line"><span class="comment">    1.此处可以获取到DOM节点(如果需要操作真实DOM的话)</span></div><div class="line"><span class="comment">    2.网络请求</span></div><div class="line"><span class="comment">    3.调用setState会触发render()</span></div><div class="line"><span class="comment">    **/</span></div><div class="line">    componentDidMount()&#123;&#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">    1.被加载组件接收到新的props被调用</span></div><div class="line"><span class="comment">    2.调用setState会触发render()。。。。。如果调用setState的话，需要进行数据对比</span></div><div class="line"><span class="comment">      对于简单的值，可以比较this.props.X === nextProps.X，但是对于复杂数据类型(Object来讲)需要进行深度对比(利用loadsh/immuable)</span></div><div class="line"><span class="comment">    **/</span></div><div class="line">    componentWillReceiveProps(nextProps, nextContext)&#123;&#125;</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">    1.用于进行不必要的渲染</span></div><div class="line"><span class="comment">    如果props,state的变化不是想要的，可以根据该方法来进行阻止渲染 return false;</span></div><div class="line"><span class="comment">    2.不能调用setState()</span></div><div class="line"><span class="comment">    **/</span></div><div class="line">    shouldComponentUpdate(nextProps, nextState, nextContext)</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">    1.在组件获取新的state/props 且在render()之前发生</span></div><div class="line"><span class="comment">    2.不能调用setState()回发生死循环</span></div><div class="line"><span class="comment">    **/</span></div><div class="line">    componentWillUpdate(nextProps, nextState, nextContext)</div><div class="line">    <span class="comment">/**</span></div><div class="line"><span class="comment">    1.如果组件中设计了Context,该方法用于初始化context中的值</span></div><div class="line"><span class="comment">    **/</span></div><div class="line">    getChildContext() &#123;</div><div class="line">        <span class="keyword">return</span> &#123;<span class="attr">color</span>: <span class="string">"purple"</span>&#125;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">  </div><div class="line">&#125;</div><div class="line"><span class="comment">//定义Context的属性，并规定类型</span></div><div class="line">MessageList.childContextTypes = &#123;</div><div class="line">  color: PropTypes.string</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>上面的代码是采用React1.6版本所写，有一些属性的处理方式和1.5版本有点不一样</p>
<blockquote>
<p>组件的PropTypes不在React库中维护，单独用prop-types维护</p>
</blockquote>
<h1 id="React源码分析"><a href="#React源码分析" class="headerlink" title="React源码分析"></a>React源码分析</h1><p><a href="">源码地址</a><a href="https://github.com/facebook/react/releases" target="_blank" rel="external">https://github.com/facebook/react/releases</a></p>
<h2 id="React-Componet的实现"><a href="#React-Componet的实现" class="headerlink" title="React.Componet的实现"></a>React.Componet的实现</h2><p>在进行React页面开发的时候，需要进行一次继承<strong>class personComponet extends React.Component</strong>,这里涉及到React库中的<strong>Component</strong>。在该函数中定义了一些<strong>自定义组件</strong>需要用的<em>props/context/refs/updater</em>。其中props很简单，context的话，和props的作用类型，refs是获取组件的<strong>引用</strong>。而updater来讲，是用于更新组件的状态(触发组件的render())。<br>//react\packages\react\src\ReactBaseClasses.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ReactNoopUpdateQueue <span class="keyword">from</span> <span class="string">'./ReactNoopUpdateQueue'</span>;<span class="comment">//用于state信息的处理</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Base class helpers for the updating state of a component.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Component</span>(<span class="params">props, context, updater</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.props = props;</div><div class="line">  <span class="keyword">this</span>.context = context;</div><div class="line">  <span class="keyword">this</span>.refs = emptyObject;</div><div class="line">  <span class="comment">// We initialize the default updater but the real one gets injected by the</span></div><div class="line">  <span class="comment">// renderer.</span></div><div class="line">  <span class="keyword">this</span>.updater = updater || ReactNoopUpdateQueue;</div><div class="line">&#125;</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Sets a subset of the state. Always use this to mutate</span></div><div class="line"><span class="comment"> * state. You should treat `this.state` as immutable.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * There is no guarantee that `this.state` will be immediately updated, so</span></div><div class="line"><span class="comment"> * accessing `this.state` after calling this method may return the old value.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * There is no guarantee that calls to `setState` will run synchronously,</span></div><div class="line"><span class="comment"> * as they may eventually be batched together.  You can provide an optional</span></div><div class="line"><span class="comment"> * callback that will be executed when the call to setState is actually</span></div><div class="line"><span class="comment"> * completed.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * When a function is provided to setState, it will be called at some point in</span></div><div class="line"><span class="comment"> * the future (not synchronously). It will be called with the up to date</span></div><div class="line"><span class="comment"> * component arguments (state, props, context). These values can be different</span></div><div class="line"><span class="comment"> * from this.* because your function may be called after receiveProps but before</span></div><div class="line"><span class="comment"> * shouldComponentUpdate, and this new state, props, and context will not yet be</span></div><div class="line"><span class="comment"> * assigned to this.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param &#123;object|function&#125; partialState Next partial state or function to</span></div><div class="line"><span class="comment"> *        produce next partial state to be merged with current state.</span></div><div class="line"><span class="comment"> * @param &#123;?function&#125; callback Called after state is updated.</span></div><div class="line"><span class="comment"> * @final</span></div><div class="line"><span class="comment"> * @protected</span></div><div class="line"><span class="comment"> */</span></div><div class="line">Component.prototype.setState = <span class="function"><span class="keyword">function</span>(<span class="params">partialState, callback</span>) </span>&#123;</div><div class="line">  invariant(</div><div class="line">    <span class="keyword">typeof</span> partialState === <span class="string">'object'</span> ||</div><div class="line">      <span class="keyword">typeof</span> partialState === <span class="string">'function'</span> ||</div><div class="line">      partialState == <span class="literal">null</span>,</div><div class="line">    <span class="string">'setState(...): takes an object of state variables to update or a '</span> +</div><div class="line">      <span class="string">'function which returns an object of state variables.'</span>,</div><div class="line">  );</div><div class="line">  <span class="keyword">this</span>.updater.enqueueSetState(<span class="keyword">this</span>, partialState, callback, <span class="string">'setState'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Forces an update. This should only be invoked when it is known with</span></div><div class="line"><span class="comment"> * certainty that we are **not** in a DOM transaction.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * You may want to call this when you know that some deeper aspect of the</span></div><div class="line"><span class="comment"> * component's state has changed but `setState` was not called.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * This will not invoke `shouldComponentUpdate`, but it will invoke</span></div><div class="line"><span class="comment"> * `componentWillUpdate` and `componentDidUpdate`.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param &#123;?function&#125; callback Called after update is complete.</span></div><div class="line"><span class="comment"> * @final</span></div><div class="line"><span class="comment"> * @protected</span></div><div class="line"><span class="comment"> */</span></div><div class="line">Component.prototype.forceUpdate = <span class="function"><span class="keyword">function</span>(<span class="params">callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.updater.enqueueForceUpdate(<span class="keyword">this</span>, callback, <span class="string">'forceUpdate'</span>);</div><div class="line">&#125;;</div><div class="line"><span class="keyword">export</span> &#123; Component&#125;;</div></pre></td></tr></table></figure></p>
<p>这里需要简单介绍一下，上述代码有一定的删减，删除了针对 <strong>AsyncComponent/PureComponent</strong>的处理</p>
<ol>
<li>在定义Component对象的必要的props/context/refs/updater等属性</li>
<li>在对象的prototype定义必要的更新方法(setState/forceUpdate),同时在enqueueForceUpdate中注册事件</li>
<li>enqueueForceUpdate用于记录组件<strong>更新操作</strong></li>
</ol>
<h2 id="组件定义页面结构"><a href="#组件定义页面结构" class="headerlink" title="组件定义页面结构"></a>组件定义页面结构</h2><p>在页面开发过程中，是利用JSX来进行UI的构建。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;MyButton color=<span class="string">"blue"</span> shadowSize=&#123;<span class="number">2</span>&#125;&gt;</div><div class="line">  Click Me</div><div class="line">&lt;<span class="regexp">/MyButton&gt;</span></div></pre></td></tr></table></figure></p>
<p>也就是构建的代码和ui是一一对应的关系。<br>基于原生开发中html在最后页面的呈现的阶段会被DOM Parse解析为DOM Tree。同理，在进行JSX页面构建的时候，最后也是会被构建为<strong>对象</strong>。并且这个对象和DOM Parse针对html的操作处理生成的DOM是对应的。该对象被称为<strong>Virtual DOM</strong>。<br>在JSX变成Virtual DOM的过程中，有一个过客为<strong>createElement</strong>。<br>其实上面的代码在React内部会被<em>解释</em>为<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">React.createElement(</div><div class="line">  MyButton,</div><div class="line">  &#123;<span class="attr">color</span>: <span class="string">'blue'</span>, <span class="attr">shadowSize</span>: <span class="number">2</span>&#125;,</div><div class="line">  <span class="string">'Click Me'</span></div><div class="line">)</div></pre></td></tr></table></figure></p>
<p>也就是说在利用JSX对页面进行结构的构建，在被渲染为DOM之前被会<strong>React.createElement</strong>解析为一个对象。换句话来将，就是JSX构建的UI只是为了代码和UI结构匹配，最终让React识别的是由createElement处理过的代码。</p>
<h3 id="React-createElement方法处理"><a href="#React-createElement方法处理" class="headerlink" title="React.createElement方法处理"></a>React.createElement方法处理</h3><p>//react\packages\react\src\ReactElement.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Create and return a new ReactElement of the given type.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params">type, config, children</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> propName;</div><div class="line"></div><div class="line">  <span class="comment">// Reserved names are extracted(保存config中指定的属性)</span></div><div class="line">  <span class="keyword">const</span> props = &#123;&#125;;</div><div class="line"></div><div class="line">  <span class="keyword">let</span> key = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">let</span> ref = <span class="literal">null</span>;</div><div class="line">   </div><div class="line">  <span class="keyword">if</span> (config != <span class="literal">null</span>) &#123;</div><div class="line">    <span class="comment">//判断元素是否存在ref</span></div><div class="line">    <span class="keyword">if</span> (hasValidRef(config)) &#123;</div><div class="line">      ref = config.ref;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">//判断是否存在key</span></div><div class="line">    <span class="keyword">if</span> (hasValidKey(config)) &#123;</div><div class="line">      key = <span class="string">''</span> + config.key;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// Remaining properties are added to a new props object</span></div><div class="line">    <span class="comment">//处理config中属性，保存在props中。</span></div><div class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> config) &#123;</div><div class="line">      <span class="keyword">if</span> (</div><div class="line">        hasOwnProperty.call(config, propName) &amp;&amp;</div><div class="line">        !RESERVED_PROPS.hasOwnProperty(propName)</div><div class="line">      ) &#123;</div><div class="line">        props[propName] = config[propName];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// Children can be more than one argument, and those are transferred onto</span></div><div class="line">  <span class="comment">// the newly allocated props object.</span></div><div class="line">  <span class="keyword">const</span> childrenLength = <span class="built_in">arguments</span>.length - <span class="number">2</span>;<span class="comment">//从argument中获取子元素的个数</span></div><div class="line">  <span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123;</div><div class="line">    props.children = children;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">const</span> childArray = <span class="built_in">Array</span>(childrenLength);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; childrenLength; i++) &#123;</div><div class="line">      childArray[i] = <span class="built_in">arguments</span>[i + <span class="number">2</span>];</div><div class="line">    &#125;</div><div class="line">    props.children = childArray;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">    在组件定义的时候，可以用defaultProps进行组件默认属性的指定</span></div><div class="line"><span class="comment">    </span></div><div class="line"><span class="comment">  **/</span></div><div class="line">  <span class="comment">// Resolve default props</span></div><div class="line">  <span class="keyword">if</span> (type &amp;&amp; type.defaultProps) &#123;</div><div class="line">    <span class="keyword">const</span> defaultProps = type.defaultProps;</div><div class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> defaultProps) &#123;</div><div class="line">      <span class="keyword">if</span> (props[propName] === <span class="literal">undefined</span>) &#123;</div><div class="line">        props[propName] = defaultProps[propName];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">//调用ReactElement Factory进行组件的真正构建</span></div><div class="line">  <span class="keyword">return</span> ReactElement(</div><div class="line">    type,</div><div class="line">    key,</div><div class="line">    ref,</div><div class="line">    self,</div><div class="line">    source,</div><div class="line">    ReactCurrentOwner.current,</div><div class="line">    props,</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="ReactElement-Factory分析"><a href="#ReactElement-Factory分析" class="headerlink" title="ReactElement Factory分析"></a>ReactElement Factory分析</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Factory method to create a new React element. This no longer adheres to</span></div><div class="line"><span class="comment"> * the class pattern, so do not use new to call it. Also, no instanceof check</span></div><div class="line"><span class="comment"> * will work. Instead test $$typeof field against Symbol.for('react.element') to check</span></div><div class="line"><span class="comment"> * if something is a React Element.</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param &#123;*&#125; type</span></div><div class="line"><span class="comment"> * @param &#123;*&#125; key</span></div><div class="line"><span class="comment"> * @param &#123;string|object&#125; ref</span></div><div class="line"><span class="comment"> * @param &#123;*&#125; self A *temporary* helper to detect places where `this` is</span></div><div class="line"><span class="comment"> * different from the `owner` when React.createElement is called, so that we</span></div><div class="line"><span class="comment"> * can warn. We want to get rid of owner and replace string `ref`s with arrow</span></div><div class="line"><span class="comment"> * functions, and as long as `this` and owner are the same, there will be no</span></div><div class="line"><span class="comment"> * change in behavior.</span></div><div class="line"><span class="comment"> * @param &#123;*&#125; source An annotation object (added by a transpiler or otherwise)</span></div><div class="line"><span class="comment"> * indicating filename, line number, and/or other information.</span></div><div class="line"><span class="comment"> * @param &#123;*&#125; owner</span></div><div class="line"><span class="comment"> * @param &#123;*&#125; props</span></div><div class="line"><span class="comment"> * @internal</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="keyword">const</span> ReactElement = <span class="function"><span class="keyword">function</span>(<span class="params">type, key, ref, self, source, owner, props</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> element = &#123;</div><div class="line">    <span class="comment">// This tag allow us to uniquely identify this as a React Element</span></div><div class="line">    $$<span class="keyword">typeof</span>: REACT_ELEMENT_TYPE,<span class="comment">//采用ES6的Symbol进行element的处理</span></div><div class="line"></div><div class="line">    <span class="comment">// Built-in properties that belong on the element</span></div><div class="line">    type: type,</div><div class="line">    key: key,</div><div class="line">    ref: ref,</div><div class="line">    props: props,</div><div class="line"></div><div class="line">    <span class="comment">// Record the component responsible for creating this element.</span></div><div class="line">    _owner: owner,</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">return</span> element;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>其实针对Factory就是一个简单的传入传出。</p>
<h2 id="组件挂载页面"><a href="#组件挂载页面" class="headerlink" title="组件挂载页面"></a>组件挂载页面</h2><p>在利用JSX构建了页面的组织结构(内部采用React.createElement进行元素的处理)，现在需要将<strong>element</strong>进行<strong>挂载</strong>到<strong>Virtual DOM</strong>中。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HelloMessage</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;div&gt;Hello &#123;this.props.name&#125;&lt;/div&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">//进行组件的渲染(mount阶段)</span></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;HelloMessage name=<span class="string">"John"</span> /&gt;,</div><div class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>)</div><div class="line">);</div></pre></td></tr></table></figure></p>
<p>在利用JSX将UI结构构建完成之后，就需要将组件<strong>挂载</strong>到DOM上。<br><a href="https://reactjs.org/docs/react-dom.html#overview" target="_blank" rel="external">ReactDOM.render()</a>用于将组件挂载到DOM<br>在react-dom库中，ReactDOM和React一样，就是一个简单对象，内置很多属性，其中<strong>render()</strong>就是用于渲染的。<br>//react-dom\lib\ReactDOM.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ReactMount = <span class="built_in">require</span>(<span class="string">'./ReactMount'</span>);</div><div class="line"><span class="keyword">var</span> findDOMNode = <span class="built_in">require</span>(<span class="string">'./findDOMNode'</span>);</div><div class="line"><span class="keyword">var</span> ReactDOM = &#123;</div><div class="line">  findDOMNode: findDOMNode,</div><div class="line">  render: ReactMount.render,</div><div class="line">&#125;;</div><div class="line"><span class="built_in">module</span>.exports = ReactDOM;</div></pre></td></tr></table></figure></p>
<p>上面代码有一定的删减，只是留下来开发中用到的。可以看到在ReactDOM.render()中render属性是由ReactMount中定义的。<br>react-dom\lib\ReactMount.js</p>
<h3 id="ReactDOM-render-解析"><a href="#ReactDOM-render-解析" class="headerlink" title="ReactDOM.render()解析"></a>ReactDOM.render()解析</h3><p>在进行ReactDOM.render()操作的时候，是调用的ReactMount中的render()</p>
<h4 id="ReactMount-render-分析"><a href="#ReactMount-render-分析" class="headerlink" title="ReactMount.render()分析"></a>ReactMount.render()分析</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment">  * Renders a React component into the DOM in the supplied `container`.</span></div><div class="line"><span class="comment">  *</span></div><div class="line"><span class="comment">  * If the React component was previously rendered into `container`, this will</span></div><div class="line"><span class="comment">  * perform an update on it and only mutate the DOM as necessary to reflect the</span></div><div class="line"><span class="comment">  * latest React component.</span></div><div class="line"><span class="comment">  *</span></div><div class="line"><span class="comment">  * @param &#123;ReactElement&#125; nextElement Component element to render.</span></div><div class="line"><span class="comment">  * @param &#123;DOMElement&#125; container DOM element to render into.</span></div><div class="line"><span class="comment">  * @param &#123;?function&#125; callback function triggered on completion</span></div><div class="line"><span class="comment">  * @return &#123;ReactComponent&#125; Component instance rendered in `container`.</span></div><div class="line"><span class="comment">  */</span></div><div class="line"> render: <span class="function"><span class="keyword">function</span> (<span class="params">nextElement, container, callback</span>) </span>&#123;</div><div class="line">   <span class="keyword">return</span> ReactMount._renderSubtreeIntoContainer(<span class="literal">null</span>, nextElement, container, callback);</div><div class="line"> &#125;,</div></pre></td></tr></table></figure>
<h4 id="ReactMount-renderSubtreeIntoContainer-分析"><a href="#ReactMount-renderSubtreeIntoContainer-分析" class="headerlink" title="ReactMount._renderSubtreeIntoContainer()分析"></a>ReactMount._renderSubtreeIntoContainer()分析</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">_renderSubtreeIntoContainer: <span class="function"><span class="keyword">function</span> (<span class="params">parentComponent, nextElement, container, callback</span>) </span>&#123;</div><div class="line">  <span class="comment">/**TopLevelWrapper这里只是一个临时的数据项，</span></div><div class="line"><span class="comment">  var topLevelRootCounter = 1;</span></div><div class="line"><span class="comment">  var TopLevelWrapper = function () &#123;</span></div><div class="line"><span class="comment">    this.rootID = topLevelRootCounter++;</span></div><div class="line"><span class="comment">  &#125;;</span></div><div class="line"><span class="comment">  **/</span></div><div class="line">  <span class="comment">//主要目的就是根据nextElement来构建对象</span></div><div class="line">  <span class="keyword">var</span> nextWrappedElement = React.createElement(TopLevelWrapper, &#123;</div><div class="line">    child: nextElement</div><div class="line">  &#125;);</div><div class="line">  <span class="comment">//在React Virtual DOM中获取container的实例。</span></div><div class="line">  <span class="keyword">var</span> prevComponent = getTopLevelWrapperInContainer(container);</div><div class="line">  <span class="comment">//如果存在的话，说明该组件已经被实例化在DOM树上，所以该render属于更新阶段</span></div><div class="line">  <span class="keyword">if</span> (prevComponent) &#123;</div><div class="line">    <span class="keyword">var</span> prevWrappedElement = prevComponent._currentElement;</div><div class="line">    <span class="keyword">var</span> prevElement = prevWrappedElement.props.child;</div><div class="line">    <span class="keyword">if</span> (shouldUpdateReactComponent(prevElement, nextElement)) &#123;</div><div class="line">      <span class="keyword">var</span> publicInst = prevComponent._renderedComponent.getPublicInstance();</div><div class="line">      <span class="keyword">var</span> updatedCallback = callback &amp;&amp; <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        callback.call(publicInst);</div><div class="line">      &#125;;</div><div class="line">      ReactMount._updateRootComponent(prevComponent, nextWrappedElement, nextContext, container, updatedCallback);</div><div class="line">      <span class="keyword">return</span> publicInst;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      ReactMount.unmountComponentAtNode(container);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">    <span class="keyword">var</span> component = ReactMount._renderNewRootComponent(nextWrappedElement, container, nextContext)._renderedComponent.getPublicInstance();</div><div class="line">  <span class="keyword">return</span> component;</div><div class="line">&#125;,</div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Render a new component into the DOM. Hooked by hooks!</span></div><div class="line"><span class="comment"> *</span></div><div class="line"><span class="comment"> * @param &#123;ReactElement&#125; nextElement element to render</span></div><div class="line"><span class="comment"> * @param &#123;DOMElement&#125; container container to render into</span></div><div class="line"><span class="comment"> * @return &#123;ReactComponent&#125; nextComponent</span></div><div class="line"><span class="comment"> */</span></div><div class="line">_renderNewRootComponent: <span class="function"><span class="keyword">function</span> (<span class="params">nextElement, container, context</span>) </span>&#123;</div><div class="line">  <span class="comment">//实例化组件(将nextElement挂载到DOM中)</span></div><div class="line">  <span class="keyword">var</span> componentInstance = instantiateReactComponent(nextElement, <span class="literal">false</span>);</div><div class="line"></div><div class="line">  <span class="comment">// The initial render is synchronous but any updates that happen during</span></div><div class="line">  <span class="comment">// rendering, in componentWillMount or componentDidMount, will be batched</span></div><div class="line">  <span class="comment">// according to the current batching strategy.</span></div><div class="line">  <span class="comment">//这里利用批处理来进行组件的更新操作</span></div><div class="line">  ReactUpdates.batchedUpdates(batchedMountComponentIntoNode, componentInstance, container, context);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> componentInstance;</div><div class="line">&#125;,</div></pre></td></tr></table></figure>
<p>上面的代码需要有一个地方，就是在进行批处理的时候，内部有有一套比较机制用于进行组件的<a href="https://zhuanlan.zhihu.com/p/20328570" target="_blank" rel="external">高效更新</a></p>
<h2 id="Buzzer"><a href="#Buzzer" class="headerlink" title="Buzzer"></a>Buzzer</h2><p>其实针对React中Element/Component渲染到真正的DOM上，需要很多过程。<br>针对React这个库，就是定义了一些组件中的<a href="https://reactjs.org/docs/react-component.html" target="_blank" rel="external">生命周期</a>/Context/State等<br>而涉及到加载/更新/卸载等操作都是在ReactDOM中。</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/avatar.png" alt="踽踽前行的路人 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/avatar.png" alt="踽踽前行的路人 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/React/" rel="tag"># React</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/01/24/React-Router-Acquaintance/" rel="next" title="初识React-Router">
                <i class="fa fa-chevron-left"></i> 初识React-Router
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="踽踽前行的路人" />
            
              <p class="site-author-name" itemprop="name">踽踽前行的路人</p>
              <p class="site-description motion-element" itemprop="description">天道酬勤</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/fanxiaowei" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://theme-next.iissnan.com/getting-started.html" title="利用hexo构建个人博客" target="_blank">利用hexo构建个人博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://doc.react-china.org" title="React中文官网" target="_blank">React中文官网</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.w3schools.com/css/css_intro.asp" title="css 英文官网" target="_blank">css 英文官网</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://es6.ruanyifeng.com/" title="Es6教程" target="_blank">Es6教程</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#React的基本操作"><span class="nav-number">1.</span> <span class="nav-text">React的基本操作</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#React源码分析"><span class="nav-number">2.</span> <span class="nav-text">React源码分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#React-Componet的实现"><span class="nav-number">2.1.</span> <span class="nav-text">React.Componet的实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#组件定义页面结构"><span class="nav-number">2.2.</span> <span class="nav-text">组件定义页面结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#React-createElement方法处理"><span class="nav-number">2.2.1.</span> <span class="nav-text">React.createElement方法处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ReactElement-Factory分析"><span class="nav-number">2.2.2.</span> <span class="nav-text">ReactElement Factory分析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#组件挂载页面"><span class="nav-number">2.3.</span> <span class="nav-text">组件挂载页面</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ReactDOM-render-解析"><span class="nav-number">2.3.1.</span> <span class="nav-text">ReactDOM.render()解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ReactMount-render-分析"><span class="nav-number">2.3.1.1.</span> <span class="nav-text">ReactMount.render()分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ReactMount-renderSubtreeIntoContainer-分析"><span class="nav-number">2.3.1.2.</span> <span class="nav-text">ReactMount._renderSubtreeIntoContainer()分析</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Buzzer"><span class="nav-number">2.4.</span> <span class="nav-text">Buzzer</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">踽踽前行的路人</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  



  
  





  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_lines.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/canvas_sphere.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  
  

  

  

  

</body>
</html>
